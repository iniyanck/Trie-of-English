/* --- CSS VARIABLES (THEMING) --- */
:root {
    /* LIGHT MODE (Default) */
    --bg-color: #f4f6f8;
    --text-color: #2c3e50;
    --text-subtle: #58697a;
    --panel-bg: #ffffff;
    --panel-shadow: rgba(0,0,0,0.1);
    
    /* Node Colors */
    --node-fill: #69b3a2;
    --node-stroke: #fff;
    --node-root: #4a90e2; 
    --node-sink: #ff7f0e;
    
    /* Link Colors */
    --link-stroke: #a0aab5;
    
    /* Logic Highlighting (Pastels for Light Mode) */
    --highlight-color: #e67e22; /* Orange */
    --ancestor-fill: #a1d99b;   /* Soft Green */
    --ancestor-stroke: #41ab5d;
    --descendant-fill: #9ecae1; /* Soft Blue */
    --descendant-stroke: #2171b5;
    
    --word-bg: #eef2f5;
}

body.dark-mode {
    /* DARK MODE (Electric Blue / Neon Green) */
    --bg-color: #0d1117;        /* Very Dark Blue-Grey (Github-like) */
    --text-color: #e6e6e6;      /* Near-White for General Text */
    --text-subtle: #8b949e;     /* Muted Grey */
    --panel-bg: #161b22;        /* Dark Panel Background */
    --panel-shadow: rgba(0,0,0,0.8); /* Stronger shadow */
    
    /* Node Colors */
    --node-fill: #34495e;       /* Deep Slate Blue (Good contrast for white text) */
    --node-stroke: #58697a;     /* Slightly lighter border for definition */
    --node-root: #4299e1;       /* Bright Sky Blue */
    --node-sink: #ff6b81;       /* Vibrant Red-Pink (Kept for 'sink' contrast) */
    
    /* Link Colors */
    --link-stroke: #4a5568;     /* Visible medium grey */
    
    /* Logic Highlighting (MODIFIED: LIGHT GREEN) */
    --highlight-color: #d48a00; /* Now Bright Lime Green (New High Contrast Focus) */
    
    /* Logic Flow (MODIFIED: DARK GREEN) */
    --ancestor-fill: #008000;   /* Now Dark Green */
    --ancestor-stroke: #00b300; /* Darker Green for stroke */
    
    --descendant-fill: #006c8d; /* Neon Purple (Kept) */
    --descendant-stroke: #3098c8;
    
    --word-bg: #1f2833;
}

/* Ensure the text inside nodes uses the general text color (for better visibility) */
.node-label {
    /* ... existing styles ... */
    fill: var(--text-color); /* This will now be #e6e6e6 */
}

body { margin: 0; overflow: hidden; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: var(--bg-color); transition: background-color 0.3s; }

#graph-container {
    width: 100vw;
    height: 100vh;
    background-color: var(--bg-color);
    position: relative;
    transition: background-color 0.3s;
}

/* --- GRAPH NODES & LINKS --- */
.node {
    fill: var(--node-fill);
    stroke: var(--node-stroke);
    stroke-width: 1.5px;
    cursor: pointer;
    transition: fill 0.3s ease, stroke 0.3s ease, opacity 0.3s;
}
.node.root { fill: var(--node-root); }
.node.sink-end-node {
    fill: var(--node-sink);
    stroke: var(--highlight-color);
    stroke-width: 3px;
}
.link {
    stroke: var(--link-stroke);
    stroke-opacity: 0.4;
    stroke-width: 1px;
    transition: stroke 0.3s ease, stroke-opacity 0.3s ease;
}
.node-label {
    font-size: 12px;
    fill: var(--text-color);
    font-weight: 500;
    pointer-events: none;
    user-select: none;
    text-anchor: middle;
    transition: opacity 0.3s ease, fill 0.3s;
}

/* Highlight Styles - Now using variables for theme swapping */
.node.highlighted { stroke: var(--highlight-color); stroke-width: 3px; }
.node.ancestor { fill: var(--ancestor-fill); stroke: var(--ancestor-stroke); stroke-width: 2px; }
.node.descendant { fill: var(--descendant-fill); stroke: var(--descendant-stroke); stroke-width: 2px; }

.link.highlighted-path { stroke: var(--highlight-color); stroke-width: 2.5px; stroke-opacity: 1; }
.link.ancestor-link { stroke: var(--ancestor-stroke); stroke-width: 2px; stroke-opacity: 0.6; }
.link.descendant-link { stroke: var(--descendant-stroke); stroke-width: 2px; stroke-opacity: 0.6; }

.node.dimmed { opacity: 0.1; }
.link.dimmed { stroke: var(--link-stroke); stroke-opacity: 0.05; }
.node-label.dimmed { opacity: 0; }

/* --- UI PANEL --- */
#ui-container {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 320px;
    background: var(--panel-bg);
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 10px 25px var(--panel-shadow);
    color: var(--text-color);
    
    display: flex;
    flex-direction: column;
    opacity: 0;
    visibility: hidden;
    transform: translateY(-20px);
    transition: opacity 0.4s ease, transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28), visibility 0.4s, background-color 0.3s;
    
    z-index: 1000;
    max-height: 85vh;
}

#ui-container.visible {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
}

#ui-container h3 { margin: 0 0 15px 0; font-size: 18px; color: var(--text-color); border-bottom: 1px solid var(--link-stroke); padding-bottom: 10px; }

/* Node Info Section inside Panel */
#node-info-display {
    margin-bottom: 15px;
    padding: 10px;
    background-color: var(--bg-color);
    border-radius: 6px;
    border-left: 4px solid var(--highlight-color);
}
#node-info-display p { margin: 4px 0; font-size: 13px; color: var(--text-subtle); }
#node-info-display strong { color: var(--text-color); }

/* Buttons */
button#gen-btn {
    background-color: var(--ancestor-stroke);
    color: white;
    padding: 12px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    width: 100%;
    margin-bottom: 10px;
    transition: background-color 0.2s, transform 0.1s;
}

button#gen-btn:hover { filter: brightness(110%); }
button#gen-btn:active { transform: scale(0.98); }

/* Word List */
#word-list {
    overflow-y: auto;
    overflow-x: hidden;
    flex-grow: 1;
    border-top: 1px solid var(--link-stroke);
    margin-top: 10px;
    padding-top: 15px;
    padding-right: 5px;
}

/* Custom Scrollbar for word list */
#word-list::-webkit-scrollbar { width: 6px; }
#word-list::-webkit-scrollbar-track { background: transparent; }
#word-list::-webkit-scrollbar-thumb { background-color: var(--text-subtle); border-radius: 3px; opacity: 0.5; }

.generated-word {
    display: block;
    font-family: 'Courier New', monospace;
    font-size: 15px;
    margin-bottom: 8px;
    padding: 8px;
    background: var(--word-bg);
    border-radius: 4px;
    color: var(--text-color);
    
    opacity: 0;
    transform: translateX(10px);
    animation: slideIn 0.3s forwards ease-out;
}

@keyframes slideIn {
    to { opacity: 1; transform: translateX(0); }
}

/* Color Coding for Text */
.char-ancestor { color: var(--ancestor-stroke); font-weight: bold; } 
.char-focus { color: var(--highlight-color); font-weight: bold; text-decoration: underline; } 
.char-descendant { color: var(--descendant-stroke); font-weight: bold; }

.empty-msg { color: var(--text-subtle); font-style: italic; font-size: 13px; text-align: center; margin-top: 20px; }
.instruction-text { font-size: 12px; color: var(--text-subtle); margin-bottom: 10px; line-height: 1.4; }

/* --- THEME TOGGLE --- */
#theme-toggle {
    position: fixed;
    top: 20px;
    left: 20px;
    background: var(--panel-bg);
    border: 1px solid var(--link-stroke);
    fill: var(--text-color); /* SVG fill */
    color: var(--text-color);
    padding: 0;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    cursor: pointer;
    box-shadow: 0 2px 10px var(--panel-shadow);
    z-index: 1001;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.3s, transform 0.2s, fill 0.3s;
}
#theme-toggle:hover { transform: scale(1.1); border-color: var(--highlight-color); }
#theme-toggle svg { width: 20px; height: 20px; }